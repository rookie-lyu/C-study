[TOC]

##### 1.TCP/IP 参考模型

(1) 应用层： 对应 OSI 参考模型的高层， 为用户提供所需要各种服务， 例如： FTP、 Telnet、
DNS、 SMTP 等
(2) 传输层： 对应 OSI 参考模型的传输层， 为应用进程间提供端到端的逻辑通信， 保证了数
据包的顺序传送及数据的完整性。 该层定义了两个主要的协议： 传输控制协议（TCP）
和用户数据报协议（UCP） 。 TCP 协议提供的是一种可靠的、 面向连接的数据传输服务；
而 UDP 协议提供的则是不可靠的、 无连接的数据传输协议。
(3) 网际层： 对应于 OSI 参考模型的网络层， 为主机之间提供逻辑通信。 网络层重新赋予主
机一个 IP 地址来完成对主机的寻址， 它还负责数据包在多种网络中的路由。 该层有四
个主要协议： 网际协议（IP） 、 地址解析协议（ARP） 、 互联网组管理协议（IGMP） 和
互联网控制报文协议（ICMP） 。
(4) 网络接口层： 与 OSI 参考模型中的物理层和数据链路层相对应。 它负责监视数据在主机
和网络之间的交换。 事实上， TCP/IP 本身并未定义该层的协议， 而是由参与互连的各网
络使用自己的物理层和数据链路层协议， 然后与 TCP/IP 的网络接口层进行连接。  

##### 2.OSI 分层（7 层）

： 应用层、 表示层、 会话层、 传输层、 网络层、 数据链路层、 物理层
(1) 物理层： 物理层使设备之间能够接受和发送比特流。 物理层的主要任务就是确定与传输
媒体的接口有关的一些特性， 如机械特性、 电气特性、 功能特性和过程特性。
(2) 数据链路层： 数据链路层传送的协议数据单元是帧。 数据链路层的三个基本问题是： 封
装成帧， 透明传输和差错检测。
(3) 会话层： 会话层管理主机之间的会话进程， 即负责建立、 管理、 终止进程之间的会话。
会话层还利用在数据中插入检验点来实现数据的同步。
(4) 表示层： 表示层对上层数据或信息进行变换以保证一个主机应用层信息可以被另一个主
机所理解。 表示层数据包转换包括数据的加密、 压缩、 格式转换等。  

##### 3.常见应用层协议的端口号

（1） HTTP： TCP， 80
（2） HTTPs： TCP， 443
（3） FTP： 控制， TCP， 21； 默认数据： TCP 20
（4） Telnet TCP 23
（5） SMTP TCP 25
（6） DNS UDP 53
（7） DHCP UDP  

##### 4.三报文握手：

(1) 假定主机 A 运行的是 TCP 客户程序， 而 B 运行 TCB 服务器程序。 最初两端的 TCP 进程
都处于 CLOSED（关闭） 状态。
(2) 一开始， B 的 TCP 服务器进程先创建传输控制块 TCB， 准备接受客户进程的连接请求。
然后服务器进程就处于 LISTEN（收听） 状态， 等待客户的连接请求。 如有， 即做出响应。
(3) A 的 TCP 客户进程也是首先创建传输控制模块 TCB。 然后， 在打算进行 TCP 连接时， 向
B 发出连接请求报文段， 这时首部中的同步位 SYN=1， 同时选择一个初始序号 seq=x。
TCP 规定， SYN 报文段（即 SYN=1 的报文段） 不能携带数据， 但要消耗掉一个序号。 这
时， TCP 客户进程进入 SYN-SENT（同步已发送） 状态。
(4) B 收到连接请求报文段后， 如同意建立连接， 则向 A 发送确认。 在确认报文段中应把
SYN 位和 ACK 位都置为 1， 确认号是 ack=x+1， 同时也为自己选择一个初始序号 seq=y。
请注意， 这个报文段也不能携带数据， 但同样要消耗掉一个序号。 这时 TCP 服务器进
程进入 SYN-RCVD（同步收到） 状态。
(5) TCP 客户进程收到 B 的确认后， 还要向 B 给出确认。 确认报文段的 ACK 置 1， 确认号
ack=y+1， 而自己的序号 seq=x+1。 TCP 的标准规定， ACK 报文段可以携带数据。 但如果
不携带数据则不消耗序号， 在这种情况下， 下一个数据报文段的序号仍是 seq=x+1。 这
时， TCP 连接已经建立， A 进入 EATABLISHED（已建立连接） 状态。
当 B 收到 A 的确认后， 也进入 ESTABLISHED（已建立连接） 状态。  

##### 5.为什么 TCP 建立连接需要三次握手， 两次行不行

不行， 三次握手可以防止已失效的连接请求报文段突然又传送到了 B
考虑一种正常情况， A 发出连接请求， 但因连接请求报文丢失未收到确认。 于是 A 再重传一
次连接请求。 后来收到了确认， 建立了连接。 数据传输完毕， 就释放了连接。 A 共发送了两
个连接请求报文段， 其中第一个丢失， 第二个到达了 B， 没有“已失效的连接请求报文段” 。
现假定出现一种异常情况， 即 A 发出的第一个连接请求报文段并没有丢失， 而是在某些网
络结点产长时间滞留了， 以致延误到连接释放以后的某个时间才到达 B。 本来这是一个早已
失效的报文段。 但 B 收到此失效的连接请求报文段后， 就误认为是 A 又发出一次新的连接
请求。 于是就向 A 发出确认报文段， 同意建立连接。 假定不采用三报文握手， 那么只要 B
发出确认， 新的连接就建立了。
由于现在 A 并没有发出建立连接的请求， 因此不会理睬 B 的确认， 也不会向 B 发送数据。
但 B 却以为新的运输连接已经建立了， 并一直等待 A 发来数据。 B 的许多资源就这样白白浪
费了。
采用三报文握手的办法， 可以防止上述现象的发生。 例如在刚才的异常情况下， A 不会像 B
的确认发出确认。 B 由于收不到确认， 就知道 A 并没有要求建立连接。  

##### 6.三次握手过程中做了哪些准备工作

（1） 双方的初始序号（2） 窗口协商， 即双方的接受窗口的大小（3） 最大的报文段的长度
（在选项中协商  

##### 7.为什么 A 在 TIME-WAIT 状态必须等待 2MSL 的时间呢？

(1) 为了保证 A 发送的最后一个 ACK 报文段能够到达 B。 这个 ACk 报文段有可能丢失， 因
而使在 LAST-ACK 状态的 B 收不到对已发送的 FIN+ACK 报文段的确认。 B 会超时重传这
个 FIN+ACK 报文段， 而 A 就能在 2MSL 时间内收到这个重传的 FIN-ACk 报文段。 接着 A
重传一个确认， 重新启动 2MSL 计时器。 最后， A 和 B 都正常进入到 CLOSED 状态。 如
果 A 在 TIME-WAIT 状态下不等待一段时间， 而是在发送完 ACK 报文段后立即释放连接，
那么就无法收到 B 重传的 FIN+ACK 报文段， 因而也不会再发送一个确认报文段。 这样，
B 就无法无法按正常步骤进入 CLOSED 状态。
(2) 防止“已失效的连接请求报文段” 出现在本连接中。 A 在发送完最后一个 ACK 报文段后，
再经过时间 2MSL， 就可以使本连接持续的时间内所产生的所有报文段都从网络中消失。
这样就可以使下一个新的连接中不会出现这种旧的连接请求报文段。  

##### 8.TCP 的主要特点：

（1） 面向连接；
（2） 每一条 TCP 连接只能是点对点的（一对一） ；
（3） 提供可靠交付的服务；
（ 4） 提供全双工通信
（ 5） 面向字节流（ 虽然应用程序和 TCP 的交互式一次一个数据块（ 大小不等） ， 但 TCP 把
应用程序交下来的数据仅仅看成是一连串的无结构的字节流 TCP 不保证接收方应用程序所
收到的数据块和发送方应用程序锁发出的数据块具有对应大小的关系）

##### 9.UDP 的主要特点

（ 1） 无连接；
（ 2） 尽最大努力交付；
（ 3） 面向报文（ 发送方的 UDP 对应用程序叫下来的报文， 在添加首部后就向下交付 IP 层。
UDP 对应用层交下来的报文， 既不合并， 也不拆分， 而是保留这些报文的边界）
（ 4） 无拥塞控制（ 网络出现的拥塞不会使源主机的发送速率降低。 这对某些实时应用是很
重要的。 很多实时的应用要求源主机以恒定的速率发送数据， 并且允许在网络发生拥塞时丢
失一些数据， 但却不允许有太大的时延。 还有一些使用 UDP 的实时应用， 需要对 UDP 的不
可靠传输进行适当的改进， 以减少数据的丢失） 。
（ 5） 支持一对一、 一对多、 多对一和多对多的交互通信
（ 6） 首部开销小（ 只有四个字段： 源端口、 目的端口、 长度、 检验和）  

##### 10.ARP 是地址解析协议， 简单语言解释一下工作原理

（ 1） 首先， 每个主机都会在自己的 ARP 缓冲区中建立一个 ARP 列表， 以表示 IP
地址和 MAC 地址之间的对应关系。
（ 2） 当源主机要发送数据时， 首先检查 ARP 列表中是否有对应 IP 地址的目的主
机的 MAC 地址， 如果有， 则直接发送数据， 如果没有， 就向本网段的所有主机
发送 ARP 请求分组， 该数据包包括的内容有： 源主机 IP 地址， 源主机 MAC 地
址， 目的主机的 IP 地址。
（ 3） 当本网络的所有主机收到该 ARP 请求分组时， 首先检查数据包中的 IP 地址
是否是自己的 IP 地址， 如果不是， 则忽略该数据包， 如果是， 则首先从请求分
组中取出源主机的 IP 和 MAC 地址写入到 ARP 列表中， 如果已经存在， 则覆盖，
然后将自己的 MAC 地址写入 ARP 响应分组中， 告诉源主机它想要找的 MAC 地址。
（ 4） 源主机收到 ARP 响应分组后。 将目的主机的 IP 和 MAC 地址写入 ARP 列表，
并利用此信息发送数据。 如果源主机一直没有收到 ARP 响应分组， 表示 ARP 查
询失败。
广播发送 ARP 请求， 单播发送 ARP 响应  

##### 11.DNS

域名系统 DNS（DimainNameSystem）是互联网使用的命名系统，用来把便于人们使用的机 器名字装换为 IP 地址。 域名到 IP 地址的解析过程的要点如下：当某一个应用进程需要把主机名解析为 IP 地址时， 该应用进程就调用解析程序，并成为 DNS 的一个客户，把待解析的域名放在 DNS 请求报文 中，以 UDP 用户数据报方式发给本地域名服务器（使用 UDP 是为了减少开销）。本地域名 服务器在查找域名后，把对应的 IP 地址放在回答报文中返回。应用进程获得目的主机的 IP 地址即可通信。 若本地域名服务器不能回答该请求，则此域名服务器就暂时成为 DNS 的另一个客户，并向 其他域名服务器查询请求。直至找到能够回答该请求的域名服务器为止。

##### 12.在浏览器中输入 www.baidu.com 后执行的全部过程

（1）客户端浏览器通过 DNS 解析到 www.baidu.com 的 IP 地址 220.181.27.48。客户端浏览 器发起一个 HTTP 会话到 220.161.27.48。 （2）在客户端的传输层，把 HTTP 会话请求分成报文段，添加源和目的端口，如服务器使 用 80 端口监听客户端的请求，客户端由系统随机选择一个端口如 5000。 （3）客户端的网络层不用关心应用层或者传输层的东西，主要做的是通过查找路由表确定 如何到达服务器，期间可能经过多个路由器。这些都是由路由器来完成的工作，无非就是通 过查找路由表决定通过那个路径到达服务器。 （4）客户端的数据链路层，通过 ARP 协议查找下一跳的 IP 地址对应的 MAC 地址，发送 ARP 请求报文，如果得到回应，就可以使用 MAC 地址发送 MAC 帧。最终，可发送 IP 数据报到 服务器。

##### 13.统一资源定位符 URL（UniformResourceLocator）

URL 用来标志万维网上的各种文档，实际上就是在互联网上的资源的地址。URI统一资源标识符
18.超文本传送协议 HTTP（HyperTextTransferProtocol）
HTTP 是一个应用于层协议，它使用 TCP 连接进行可靠的传送。 HTTP 协议定义了浏览器（即万维网客户进程）怎样向万维网服务器请求万维网文档，以及 服务器怎样把文档传送给浏览器。
HTTP 使万维网客户程序与万维网服务器程序之间的交互遵循严格的协议。
19.连续 ARQ 协议
发送方维持一个发送窗口，位于发送窗口内的分组（滑动窗口协议为字节）都可以发送出去， 而不需要等待对方的确认。这样可以信道利用率。 发送方收到一个确认，就可以将发送窗口向前滑动。 接收方一般都采用累积确认的方式。这就是说，接收方不必对收到的分组逐个发送确认，而 是在收到几个分组后，对按序到达的最后一个分组发送确认。

##### 14.TCP 拥塞控制总体思路

（1）发送方维持一个叫做拥塞窗口的状态变量。拥塞窗口的大小取决于网络的拥塞程度， 并且动态地在变化。发送方让自己的发送窗口等于拥塞窗口。 （2）只要网络中没有出现拥塞，拥塞窗口就可以再增大一些，提高网络的利用率；只要网 络中出现拥塞或有可能出现拥塞，就必须把拥塞窗口减少一些，以减少注入到网络中的分组 数，以便缓解网络出现的拥塞。 （3）判断网络拥塞的依据就是出现了超时。

##### 15.TCP 拥塞控制的算法

慢开始、拥塞避免、快重传和快恢复 （1）慢开始：由小到大逐步增大拥塞窗口数值；但拥塞窗口的增长速率并不慢，每经过一 个传输轮次，拥塞窗口就加倍。 （2）拥塞避免：拥塞窗口的数值超过慢开始门限，就执行拥塞避免算法。让拥塞窗口缓慢 增大，即按线性规律缓慢增长。 （3）快重传：接收方不是捎带确认，而是立即发送确认，即使收到失序的报文段也要对已 收到的报文段重复确认。只要发送方一连收到多个重复确认，就知道接收方没有收到，因而 立即进行重传，从而避免超时重传从而避免重新执行慢开始算法。 （4）快恢复：当仅仅是出现个别报文段丢失，而不是出现网络拥塞的情况，不启动慢开始 算法，而是执行快恢复算法。发送方调整慢开始门限为当前拥塞窗口的 1/2，同时拥塞窗口 也减半，并开始执行拥塞避免算法。

![xiaoguo](C:\Users\wsgbcsc\Desktop\image\yoongsai.PNG)

##### 16.HTTP：

超文本传输协议 HTTP 协议被用于在 Web 浏览器和网站服务器之间传递信息

##### 17.HTTPs：

安全套接字层超文本传输协议 HTTPs 是 HTTP 的安全版，在 HTTP 的基础上加入了 SSL 协议， SSL 依靠证书来验证服务器的身份，并为浏览器和服务器之间的通信加密

##### 18.HTTP 和 HTTPs 的区别：

（1）https 需要到 ca 申请证书，一般免费证书很少，需要交费 （2）http 的信息是明文传输，https 则是具有安全性的 ssl 加密传输协议 （3）http 和 https 使用的是完全不同的连接方式，用的端口也不一样，前者是 80，后者是 443。 （4）http 的连接很简单，是无状态的；https 协议是由 SSL+HTTP 构建的可进行加密传输、
身份验证的网络协议，比 http 安全。

##### 19.HTTP1.0 和 HTTP1.1 的区别

（1）HTTP1.1 支持长连接和流水线工作方式 （2）HTTP1.1 增加了 host 字段 （3）HTTP1.1 更加节约带宽（新的状态 100（Continue）） （4）HTTP1.1 引入了 Chunkedtrnasferconding，发送方可以将消息分割成若干个任意大小的 数据块，每个数据块在发送时都会附上块的长度，最后用一个零长度的块作为消息结束的标 志。这种方法允许发送方只缓冲消息的一个片段，避免缓冲整个消息带来的过载。 https://www.cnblogs.com/gofighting/p/5421890.html



##### 20.TCP首部


TCP 报文段首部的前 20 个字节是固定的， 后面有 4n 字节是根据需要而增加的选项。因此 TCP 首部的最小长度是 20 字节

##### 21.UDP 的首部格式

UDP 首部字段很简单，只有 8 个字节，由四个字段组成，每个字段的长度都是两个字节

##### 22.粘包出现的原因

（1）发送端等缓冲区满之后才发送数据 （2）接受方未能及时接受缓冲区的包，造成粘包 注：传输的数据为不带结构的连续流数据（如文件传输），不需要处理粘包现象； 带结构的数据需要做分包处理。

##### 23粘包问题的解决方案

（1）发送固定长度的消息 （2）把消息的尺寸与消息一块发送 （3）使用特殊标记作为消息之间的间隔
30.三次握手什么时候会变成四次握手
先发送一个确认报文段，再发送一个同步报文段

##### 24.滑动窗口协议

发送方维持一个发送窗口，接收方维持一个接受窗口，发送方的发送窗口不能超过接受方的 接受窗口的数值；滑动窗口以字节为单位，位于发送窗口内的字节都可以连续发送出去，而 不需要等待对方的确认，这样，就可以提高信道的利用率。接收方不必对收到的分组逐个发 送确认，而是采用累积确认的方式，对按序到达的最后一个分组发送确认。发送方每收到一 个确认，就把发送窗口向前滑动。 使用滑动窗口协议可以实现 TCP 可靠传输，流量控制。

##### 25.累积确认的优缺点：

优点：容易实现，即使确认丢失也不必重传。 缺点：不能向发送方反映出接收方已经正确收到的所有分组的信息，产生 Go-back-N 现象。 注：避免累积确认：使用选择确认 SACK

##### 26.超时重传时间的选择：

对报文段的往返时间 RTT 进行加权平均，再加上 4 倍的 RTT 的偏差的加权平均。
注：在计算加权平均 RTTS 时，只要报文段重传了，就不采用其往返时间样本。

##### 27.流量控制：

让发送方的发送速率不要太快，要让接收方来得及接收，可以使用滑动窗口机制进行流量控
制。
注：如何解决非零窗口的通知丢失，互相等待的死锁局面：TCP 为每一个连接设有一个持续 计时器，只要 TCP 连接的一方收到对方的零窗口通知，就启动持续计时器。若持续计时器设 置的时间到期，就发送一个零窗口探测报文段。

##### 28.TCP 报文段的传输时机

（1）TCP 缓存中存放的数据达到最大报文段长度 （2）发送方的应用进程指明要发送报文段，即 TCP 支持的推送操作 （3）计时器的期限到

##### 29.（如何提高）TCP 的传输效率

（1）捎带确认 （2）Nagle 算法：只有在收到对前一个报文段的确认后才继续发送下一个报文段，当数据 到达较快而网络速率较慢时，用这样的方法可明显减少使用的网络带宽；当到达的数据已达 到发送窗口大小的一半或已达到报文段的最大长度时，就立即发送一个报文段。这样做，就 可以有效地提高网络的吞吐量。 （3）如何解决糊涂窗口综合征： 发送方不发送很小的报文段，接收方也不要在缓存刚刚有了一点小的空间就急忙把这个很小 的信息通知发送方
：

##### 30.HTTP 状态码

（1）1**表示通知消息，如请求收到了或正在处理。 （2）2**表示成功，如接受或知道了。 （3）3**表示重定向，如要完成请求还必须采取进一步的行动。 （4）4**表示客户的差错，如请求中有错误的语法或不能完成请求。 （5）5**表示服务器的差错，如服务器失效无法完成请求。
39.状态的含义：
(1) 200：服务器已成功处理了请求。通常，这表示服务器提供了请求的网页。 (2) 201：表示请求成功并且服务器创建了新的资源，且其 URI 已经随 Location 头信息返回
(3) 202：服务器已接受请求，但尚未处理。 (4) 301:所请求的资源已永久移动到新位置。并且将来任何对此资源的引用都应该使用本响 应返回的若干 URI 之一。 (5) 302：所请求的资源现在临时从不同的 URI 响应请求。由于这样的重定向是临时的，客 户端应该继续向原有地址发送以后的请求。 (6) 304：自从上次请求后，请求的网页未修改过。 (7) 400：服务器不能理解请求的语法。 (8) 401：当前请求需要用户验证。 (9) 403：服务器已经理解请求，但是拒绝执行它 (10) 404：服务器找不到请求的网页。例如，对于服务器上不存在的网页经常会返回此代码。 (11) 500：服务器遇到错误，无法完成请求。 (12) 503：由于临时的服务器维护或者过载，服务器当前无法处理请求。

##### 31.分析一台主机不能上网的原因

（1）TCP/IP 协议问题：通过“ping127.0.0.1”来判断 TCP/IP 是否安装成功 注：127.0.0.1 是回送地址，指本地机，一般用来测试使用 （2）网卡驱动问题：输入”ipconfig”获得本机 IP 地址，通过”Ping 本地 IP 地址”来判断网卡 或网卡驱动是否有问题 （3）网线连接问题：输入”ipconfig”获得网关地址，通过”Ping 网关 IP 地址”，如果不通则说 明问题基本出现在网线上 （4）网络防火墙设置不当：安全等级过高，不小心把 IE 放进阻止访问列表 （5）DNS 服务器问题：当 IE 无法浏览网页时，可以尝试用 IP 地址来访问，如果可以访问， 那应该是DNS的问题，造成DNS的问题可能是连网时获取DNS出错或DNS服务器本身问题， 这时可以手动指定 DNS 服务（地址可以是你当地 LSP 提供的 DNS 服务器地址，也可以用其 他地方可正常使用 DNS 服务） （6）电脑中毒
41.socket 编程

##### 32.路由信息协议 RIP(RoutingInformationProtocol)

路由信息协议：是一种分布式的基于距离向量的路由选择协议。RIP 协议认为好的路由就是 通过的路由器的数目少 RIP 协议的特点： （1）仅和相邻的路由器交换信息。 （2）路由器交换的信息是当前本路由器所知道的全部信息，即自己现在的路由表（我到本 自治系统中所有网络的（最短）距离，以及到每个网络应经过的的下一跳路由器） （3）按固定的时间间隔交换路由信息（如每隔 30 秒） RIP 协议优缺点： （1）可以收敛，并且过程很快： （2）好消息传的快，坏消息传的慢（RIP 存在的一个问题是当网络出现故障时，要经过比 较长的时间才能将此信息传送到所有的路由器）； （3）RIP 只适用于小型互联网（RIP 允许一条路径最多只能包含 15 个路由器。因此“距离” 等于 16 即相当于不可达）。

##### 33.开发最短路径优先 OSPF（OpenShortestPathFirst）

OSPF 最主要的特征即使使用分布式的链路状态协议 OSPF 的特点： （1）向本自治系统中所有路由器发送信息。这里使用的方法是洪泛法。
（2）发送的信息就是与本路由器相邻的所有路由器的链路状态。所谓“链路状态”就是说 明本路由器都和那些路由器相邻，以及该链路的“代价”。“代价”表示费用、距离、时延、 带宽，等等。 （3）只有当链路状态发生变化时，路由器才向所有路由器用洪泛法发送此信息 所有的路由器最终都能建立一个链路状态数据库，这个数据库实际上就是全网的拓扑结构 图。每个路由器利用最短路径算法构造自己的路由表。 OSPF 的优点：更新过程收敛得快 OSPF 的特点： （1）OSPF 允许管理员根据不同的业务，给每条路由指派不同的代价。例如，高带宽的卫星 链路对于非实时的业务可设置为较低的代价，但对于时延敏感的业务就可设置为非常高的代 价。因此，OSPF 对于不同类型的业务可能计算出不同的路由。这种灵活性是 RIP 所没有的。 （2）如果到同一个目的网络有多条相同代价的路径，那么可以将通信量分配给这几条路径。 这叫做多路径间的负载平衡。 （3）所有在 OSPF 路由器之间交换的分组都具有鉴别的功能，因而保证了仅在可信赖的路 由器之间交换链路状态信息。 （4）OSPF 支持可变长度的子网划分和无分类的编址 CIDR。 （5）OSPF 让每一条链路状态都带上一个 32 位的序号，序号越大状态就越新 注：不用 UDP 直接用 IP 数据报传送

##### 34.边界网关协议 BGP（Bordergatewayprotocol）

BGP 是一种基于路径向量的路由选择协议，边界网关协议只是力求寻找一条能够到达目的网 络且比较好的路由（不能兜圈子），而并非要寻找一条最佳路由。

##### 35.边界网关协议的工作过程

（1）每一个自治系统的管理员要选择至少一个路由器作为该自治系统发言人 （2）BGP 发言人要与其他 AS 的 BGP 发言人交换路由信息，就要先建立 TCP 连接（端口号 为 179），然后在此连接上交换 BGP 报文以建立 BGP 会话，利用 BGP 会话交换路由信息， 如增加了新的路由、或撤销过时的路由、以及报告出差错的情况等等。 （3）当 BGP 发言人互相交换了网络可达性信息后，各 BGP 发言人就根据所采用的策略从收 到的路由信息中找出到达各自治系统的较好的路由。

##### 36.不同自治系统之间的路由选择为什么不能使用前面讨论过的内部

网关协议？
（1）互联网的规模太大，使得自治系统 AS 之间路由选择非常困难。 1 互联网主干网上的路由器，必须对所有有效的 IP 地址都能够在路由表中找到匹配 的目的网络。假设，采用 OSPF 协议，每个路由器所要维持的链路状态数据库太过庞大，使 用最短路径算法计算最短路径也过于耗时。
2 每个 AS 采用不同内部网关协议，它们对代价的定义是不同的（在某自治系统中， 代价 1000 可能表示一条比较长的路由。但对另一 AS 代价 1000 却可能表示不可接受的坏路 径），因此要用代价作为度量来寻找最佳路由很不现实。比较合理的是在自治系统之间交换 “可达性”信息。 （2）自治系统 AS 之间的路由选择必须考虑有关策略。这些策略包括政治、安全和经济方面 的考虑。使用这些策略是为了找出较好的路径而不是最佳路径。

##### 37.ICMP：网际控制报文协议

ICMP 允许主机或路由器报告差错情况和提供有关异常情况的报告 ICMP 的应用：PING、traceroute：用来跟踪一个分组从源点到终点的路径

##### 38.PING

用来测试两台主机之间的连通性。PING 使用了 ICMP 回送请求与回送回答报文。PING 是应 用层直接使用网络层 ICMP 的一个例子。它没有通过运输层的 TCP 或 UDP

##### 39.Traceroute

工作原理：从源主机到目的主机发送一连串的 IP 数据报，数据报中封装的是无法交付的 UDP 用户数据报。第一个数据 P1 的生存时间 TTL 设置为 1。当 P1 到达路径上的第一个路由器 R1 时，路由器 R1 先收下它，接着把 TTL 的值减 1.由于 TTL 等于零了，R1 就把 P1 丢弃了，并 向源主机发送一个 ICMP 时间超过差错报告报文。

##### 40.网络地址转换 NAT（NetworkAdressTranslation）

在专用网内部的一些主机本来已经分配到了本地 IP 地址，但现在又想和互联网上的主机通 信，这时要要到网络地址装换 在专用网连接到互联网的路由器上安装 NAT 软件。装有 NAT 软件的路由器叫做 NAT 路由器， 它至少有一个有效的外部全球 IP 地址。
当从专用网向互联网发送IP数据报， NAT路由器把IP数据报的源IP地址转换为全球IP地址； 当 NAT 路由器收到互联网上的主机发来的 IP 数据报时，通过查找 NAT 地址装换表，对目的 地址进行一次 IP 数据报的转换。